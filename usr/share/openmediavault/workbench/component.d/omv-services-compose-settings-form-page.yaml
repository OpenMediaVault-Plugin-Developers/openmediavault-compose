version: "1.0"
type: component
data:
  name: omv-services-compose-settings-form-page
  type: formPage
  config:
    request:
      service: Compose
      get:
        method: get
      post:
        method: set
    fields:
      - type: divider
        title: _("Compose Files")
      - type: sharedFolderSelect
        name: sharedfolderref
        label: _("Shared folder")
        hasEmptyOption: true
        hint: _("Location of compose files")
      - type: divider
        title: _("Backup")
      - type: sharedFolderSelect
        name: backupsharedfolderref
        label: _("Shared folder")
        hasEmptyOption: true
        hint: _("Location of backups")
      - type: numberInput
        name: backupmaxsize
        label: _("Max Size")
        value: 1
        validators:
          min: 1
          max: 65536
          patternType: integer
          required: true
        hint: _("Units in GB. Backup will skip volumes larger than this size.")
      - type: divider
        title: _("Docker")
      - type: textInput
        name: dockerStorage
        label: _("Docker storage")
        value: "/var/lib/docker"
      - type: textInput
        name: dockerStatus
        label: _("Status")
        submitValue: false
        readonly: true
      - type: textInput
        name: dockerVersion
        label: _("Docker version")
        submitValue: false
        readonly: true
      - type: textInput
        name: composeVersion
        label: _("Compose version")
        submitValue: false
        readonly: true
    buttons:
      - template: submit
      - template: cancel
        execute:
          type: url
          url: "/services"
      - text: _("Reinstall Docker")
        confirmationDialogConfig:
          template: confirmation-danger
          message: _("Are you sure you want to reinstall?")
        execute:
          type: taskDialog
          taskDialog:
            config:
              title: _("Reinstall Docker ...")
              startOnInit: true
              request:
                service: Compose
                method: reinstallDocker
              buttons:
                stop:
                  hidden: true
      - text: _("Restart Docker")
        confirmationDialogConfig:
          template: confirmation-danger
          message: _("Are you sure you want to restart?")
        execute:
          type: request
          request:
            service: Compose
            method: restartDocker
            progressMessage: _("Docker is restarting ...")
            successNotification: _("Docker has been restarted.")
